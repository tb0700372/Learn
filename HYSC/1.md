# 复星

```sql

WITH a AS(
SELECT A.ADDDATE 单据时间,A.EDITDATE 编辑时间,A.ADDBY 添加人,A.EDITBY 编辑人,'入库单' 单据类型,A.RECEIPTID 单据编号,B.ITEMID 源产品,0 源数量,B.ITEMID 目标产品,B.QTYEXPECTED 目标数量,B.QTYEXPECTED 生效数量
FROM dbo.RECEIPTHD A LEFT JOIN dbo.RECEIPTDT B ON A.RECEIPTID = B.RECEIPTID WHERE A.STATUSID>=75),
b AS (
SELECT A.ADDDATE 单据时间,A.EDITDATE 编辑时间,A.ADDBY 添加人,A.EDITBY 编辑人,'订单' 单据类型,A.ORDERID 单据编号,B.ITEMID 源产品,0 源数量,B.ITEMID 目标产品,B.QTY 目标数量,B.QTY*-1 生效数量
FROM dbo.ORDERHD A LEFT JOIN dbo.ORDERDT B ON B.ORDERID = A.ORDERID WHERE A.STATUSID>=75),
c AS(
SELECT A.ADDDATE 单据时间,A.EDITDATE 编辑时间,A.ADDBY 添加人,A.EDITBY 编辑人,'调整单' 单据类型,A.ADJUSTID 单据编号,B.S_ITEMID 源产品,B.S_QTY 源数量,B.D_ITEMID 目标产品,B.D_QTY 目标数量,B.D_QTY-B.S_QTY 生效数量
FROM dbo.ADJUSTHD A LEFT JOIN dbo.ADJUSTDT B ON B.ADJUSTID = A.ADJUSTID WHERE A.STATUSID>=75),
d AS (
SELECT A.ADDDATE 单据时间,A.EDITDATE 编辑时间,A.ADDBY 添加人,A.EDITBY 编辑人,'移库单' 单据类型,A.TRANSFERID 单据编号,B.ITEMID 源产品,B.S_QTY 源数量,B.ITEMID 目标产品,B.D_QTY 目标数量,B.D_QTY-B.S_QTY 生效数量
FROM dbo.TRANSFERHD A LEFT JOIN dbo.TRANSFERDT B ON B.TRANSFERID = A.TRANSFERID  WHERE A.STATUSID>=75)
SELECT * FROM (
SELECT * FROM a UNION ALL SELECT * FROM b UNION ALL SELECT * FROM c UNION ALL SELECT * FROM d )AA WHERE AA.生效数量<>0

```

```sql



```
